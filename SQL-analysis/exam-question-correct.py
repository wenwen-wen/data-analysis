import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import sqlite3

# 連接到 SQLite 資料庫
conn = sqlite3.connect('codinghere-20240208.db')

# 建立一個游標物件
cursor = conn.cursor()

#查詢數據
cursor.execute('''

                ''')


rows = cursor.fetchall()

# 輸出查詢結果
for row in rows:
    print(row)

# 關閉連接
conn.close()

# 設置中文字體
plt.rcParams['font.sans-serif'] = ['Microsoft JhengHei']  # 替換成你的中文字體，如微軟正黑體
plt.rcParams['axes.unicode_minus'] = False  # 解決負號顯示問題

# SQL 查詢结果
data = [
    ('112-王老師運算思維與程式設計', '何沁恩', 59, 60),
    ('112-王老師運算思維與程式設計', '古定加', 38, 60),
    ('112-王老師運算思維與程式設計', '吳晏甄', 53, 60),
    ('112-王老師運算思維與程式設計', '呂宗凱', 18, 60),
    ('112-王老師運算思維與程式設計', '周晉淵', 49, 60),
    ('112-王老師運算思維與程式設計', '周煜恆', 27, 60),
    ('112-王老師運算思維與程式設計', '姚雲捷', 59, 60),
    ('112-王老師運算思維與程式設計', '孫詠鈞', 62, 60),
    ('112-王老師運算思維與程式設計', '官晸曄', 34, 60),
    ('112-王老師運算思維與程式設計', '張仲廷', 74, 60),
    ('112-王老師運算思維與程式設計', '張佑成', 36, 60),
    ('112-王老師運算思維與程式設計', '張庭瑋', 56, 50),
    ('112-王老師運算思維與程式設計', '張愷臻', 39, 60),
    ('112-王老師運算思維與程式設計', '張睿庭', 72, 60),
    ('112-王老師運算思維與程式設計', '張維珍', 42, 60),
    ('112-王老師運算思維與程式設計', '徐凱榆', 25, 30),
    ('112-王老師運算思維與程式設計', '曾弘毅', 48, 60),
    ('112-王老師運算思維與程式設計', '朱英齊', 54, 60),
    ('112-王老師運算思維與程式設計', '林依辰', 51, 60),
    ('112-王老師運算思維與程式設計', '林信豪', 17, 60),
    ('112-王老師運算思維與程式設計', '林劭恩', 111, 60),
    ('112-王老師運算思維與程式設計', '林子竣', 30, 60),
    ('112-王老師運算思維與程式設計', '林尚亭', 19, 60),
    ('112-王老師運算思維與程式設計', '林庭毅', 26, 60),
    ('112-王老師運算思維與程式設計', '林美伶', 27, 60),
    ('112-王老師運算思維與程式設計', '梁耕綸', 20, 50),
    ('112-王老師運算思維與程式設計', '楊薏主', 32, 60),
    ('112-王老師運算思維與程式設計', '楊閔翔', 21, 60),
    ('112-王老師運算思維與程式設計', '洪佑瑋', 33, 40),
    ('112-王老師運算思維與程式設計', '洪平', 95, 60),
    ('112-王老師運算思維與程式設計', '洪承浩', 43, 60),
    ('112-王老師運算思維與程式設計', '王筠凱', 32, 50),
    ('112-王老師運算思維與程式設計', '翁博軒', 31, 60),
    ('112-王老師運算思維與程式設計', '莊崴棋', 73, 60),
    ('112-王老師運算思維與程式設計', '葉威廷', 41, 60),
    ('112-王老師運算思維與程式設計', '蔡中勝', 33, 60),
    ('112-王老師運算思維與程式設計', '蔡乙慈', 62, 30),
    ('112-王老師運算思維與程式設計', '蔡宗晏', 20, 60),
    ('112-王老師運算思維與程式設計', '蕭隆曄', 21, 60),
    ('112-王老師運算思維與程式設計', '藍智瀚', 58, 60),
    ('112-王老師運算思維與程式設計', '蘇子杰', 32, 50),
    ('112-王老師運算思維與程式設計', '詹立祺', 13, 50),
    ('112-王老師運算思維與程式設計', '趙彥鈞', 63, 60),
    ('112-王老師運算思維與程式設計', '邱柏維', 43, 50),
    ('112-王老師運算思維與程式設計', '陳喆', 30, 60),
    ('112-王老師運算思維與程式設計', '陳懌鴻', 35, 60),
    ('112-王老師運算思維與程式設計', '陳昀陞', 55, 60),
    ('112-王老師運算思維與程式設計', '陳昱維', 48, 60),
    ('112-王老師運算思維與程式設計', '陳漢邦', 142, 60),
    ('112-王老師運算思維與程式設計', '陳靖淵', 69, 50),
    ('112-王老師運算思維與程式設計', '馮柏諺', 49, 60),
    ('112-王老師運算思維與程式設計', '黃品嘉', 28, 50),
    ('112-王老師運算思維與程式設計', '黃科傑', 13, 30),
    ('112-王老師運算思維與程式設計', '黃筠筑', 41, 60),
]

# 分組資料
class_a_midterm = [(d[2], d[3]) for d in data if d[0] == '112-王老師運算思維與程式設計']

# 繪製散點圖
plt.figure(figsize=(10, 6))  # 設定圖表大小

plt.scatter(*zip(*class_a_midterm), color='gold', marker='o')

plt.xlabel('平時練習成功次數')
plt.ylabel('期中考分數')
plt.title('112-王老師運算思維與程式設計')
plt.grid(True)  # 添加網格線
plt.show()


from scipy.stats import pearsonr

# 從資料中提取觀測值
submits = [row[2] for row in data]
scores = [row[3] for row in data]

# 使用 scipy.stats.pearsonr 計算皮爾森相關係數和 p-value
correlation_coefficient, p_value = pearsonr(submits, scores)

print(f"皮爾森相關係數: {correlation_coefficient:.3f}")
print(f"p-value: {p_value:.3f}")